# Tool Results and Agent Feedback

## Core Principle

Agents cannot directly observe tool results - they require explicit feedback about outcomes. The result of applying a tool becomes the follow-up prompt that guides the next action.

## Feedback Loop Process

### Basic Pattern

1. **Agent** → Specifies action to perform
2. **System** → Executes action and provides result
3. **Agent** → Receives result as next prompt input
4. **Agent** → Decides next action based on result
5. Repeat cycle

### Conversation Structure

- **Initial**: Human provides goal and constraints
- **Ongoing**: Replace human responses with tool results
- **Critical**: Each result updates agent's world state understanding

## Practical Example: Microwave Control

### Tool Definition

```md
Tools:
- microwave_get_current_time
- microwave_reset_time  
- microwave_increase_time
- microwave_stop
- microwave_start
- microwave_open_door
- microwave_close_door
- insert_food_in_microwave

Notes: You must set the time on the microwave to start it. You must work independently without input from me. You can only use the provided tools and refer to them by their name. You must complete one step at a time and wait for a description of the outcome.
```

Naming Pattern: `device_action`

### Interaction Flow

**Goal**: Reheat a quesadilla

1. **Agent**: "Use the insert_food_in_microwave tool to place the quesadilla inside"
   **Result**: "Food in microwave"

2. **Agent**: "microwave_increase_time"  
   **Result**: "Time increased by 5 seconds"

3. **Agent**: "Continue to use microwave_increase_time tool... you'll need to increase the time for 60 seconds, use the tool incrementally until you reach the desired time"
   **Result**: "Time increased to 60 seconds"

4. **Agent**: "Use the microwave_start tool to start the microwave"
   **Result**: "Error: door open"

5. **Agent**: "Use the microwave_close_door action"
   **Result**: "The door is closed"

6. **Agent**: "Now start the microwave"
   **Result**: "The microwave is running"

## Key Learning Points

### Dynamic Tool Understanding

- Agent learns tool behavior through results (5-second increment discovery)
- Must adapt strategy based on actual vs expected outcomes
- Tool specifications may be incomplete - results fill gaps

### State Management

- Each result provides updated world state information
- Agent builds understanding of system constraints through feedback
- Critical for making appropriate next decisions

### Error Handling

- Errors must include **why** action failed, not just that it failed
- "Error: door open" vs "Error 32" - context matters
- Rich error messages enable appropriate responses

## Critical Success Factors

### Result Quality

- **Specific outcomes**: "Time increased by 5 seconds" not "Time changed"
- **State information**: Current system status after action
- **Error context**: Why action failed and current state

### Error Message Design

- **Descriptive**: Clear explanation of what went wrong
- **Actionable**: Information needed to resolve the issue  
- **Contextual**: Current system state after failed action
- **Avoid**: Cryptic error codes without explanation

### Feedback Timing

- Immediate result after each action
- No action decisions without result feedback
- Maintains accurate world state understanding

## System Integration

### Computer System Naming

- Tool names closer to programming interfaces
- Function-like naming conventions (microwave_start vs "start microwave")
- Prepares for actual system integration

### Automated Feedback

- Current: Human simulates system responses
- Future: Actual computer systems provide tool results
- Same feedback principles apply regardless of source

## Common Failure Modes

### Poor Error Messages

- Systems making repeated mistakes due to inadequate feedback
- Compounding errors from lack of state clarity
- Agents stuck in loops without resolution information

### Missing Context

- Incomplete tool result information
- Lack of state updates after actions
- Insufficient error details for problem resolution

### Solution Approach

- Improve error message quality and specificity
- Provide complete state information in results
- Include actionable guidance in error responses
